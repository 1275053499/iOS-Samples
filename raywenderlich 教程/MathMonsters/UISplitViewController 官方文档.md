摘自 <https://developer.apple.com/documentation/uikit/uisplitviewcontroller?language=objc>



# UISplitViewController

一个实现 master-detail（主-从）页面的容器视图控制器。



## 声明

```objc
@interface UISplitViewController : UIViewController
```



## 概述

分体视图控制器（本文将  `UISplitViewController` 译为分体视图控制器）是一个容器视图控制器，它在一个 master-detail （主-从）页面中管理两个子视图控制器。在这种类型的页面中，主视图控制器（主视图）的变化会驱动从视图控制器（详细视图）的变化。这两个视图控制器可以并排排列，这样每次只会看到一个视图控制器页面，或者其中一个视图控制器页面会部分隐藏。在 iOS 8 及以后的版本中，你可以在所有 iOS 设备上使用 `UISplitViewController` 类；在之前的 iOS 版本中，该类只在 iPad 上可用。

在构建应用程序的用户界面时，分体视图控制器通常作为应用程序窗口的根视图控制器，但它可能被嵌入到另一个视图控制器中。分体视图控制器没有自己的主外观。它的大部分外观是由你添加的子视图控制器定义的。你可以使用接口生成器配置子视图控制器，也可以通过将视图控制器分配给 `viewControllers` 属性来以编程的方式配置子视图控制器。子视图控制器可以是自定义视图控制器或其他容器视图控制器，如导航视图控制器等。



> 注意
>
> **你不能将分体视图控制器 push 到导航栈上**。虽然可以在其他容器视图控制器中放一个分体视图控制器作为子控制器，但在大多数情况下不建议这样做。分体视图控制器通常作为应用程序窗口的根视图控制器。有关如何实现界面的提示和指导，请参阅 iOS 人机界面指南。



分体视图控制器根据可用空间决定其子视图控制器的排列。在水平正常的环境中，分体视图控制器尽可能地并排显示其视图控制器。在水平紧凑的环境中，分体视图控制器的作用更像是一个导航视图控制器，最初显示主视图控制器，然后根据需要推送或弹出从视图控制器。你还可以通过给 `preferredDisplayMode` 属性指定一个值，要求分体视图控制器以特定的方式排列。

在屏幕上显示内容时，分体视图控制器与它的 Delegation 对象一起工作，以管理其子视图控制器的呈现。Delegation 对象是您提供的对象，它需要遵守 `UISplitViewControllerDelegate` 协议。当发生变化时，使用该协议的方法来定制您的分体视图页面的行为。有关协议方法的更多信息，请参阅 `UISplitViewControllerDelegate`。



## 配置分体视图控制器界面的外观

分体视图控制器的视觉配置由其当前显示模式控制。您不直接设置显示模式，而是使用 `preferredDisplayMode` 属性间接设置。分体视图控制器会尽量尊重您指定的显示模式，但由于空间限制，可能无法在视觉上适应该模式。例如，分体视图控制器不能在水平紧凑的环境中并排显示其子视图控制器。

表1 列出了可用的显示模式，并描述了在这种显式模式下视图控制器在屏幕上的排列方式。该表还列出了用于设置指定显示模式的常量。

表1 分体视图控制器的显示模式

| 显示模式     | 描述                                                         |
| ------------ | ------------------------------------------------------------ |
| Side-by-side | 两个视图控制器同时显示在屏幕上。主视图控制器显示在左侧，通常比副视图控制器窄。您可以使用 `preferredPrimaryColumnWidthFraction` 属性调整主视图控制器的宽度。<br/><br/>当 `collapsed` 折叠属性设置为 YES 时，此显示模式不会奏效。在折叠界面中，一次只显示一个视图控制器。<br/><br/>该模式由 `UISplitableViewiewControllerDisplayModeAllVisible` 常量表示。 |
| Hidden       | 副视图控制器显示在屏幕上，主视图控制器不在屏幕上。<br/><br/>要显示主视图控制器，必须以模态样式显示或改变显示模式。<br/><br/>该模式由 `UISplitViewControllerDisplayModePrimaryHidden` 常量表示。 |
| Overlay      | 副视图控制器在屏幕上，主视图控制器层叠在其上。在这种模式下，主视图控制器部分遮挡了副视图控制器。<br/><br/>这种模式由 `UISplitableViewiewControllerDisplayModePrimaryOverlay` 常量表示。 |



设置了首选显示模式后，分体视图控制器会自行更新，并在 `displayMode` 属性中反映实际的显示模式。您可以随时更改首选的显示模式，这样做会使分体式视图控制器进行相应的自我调整。分体视图控制还安装了一个内置的手势识别器，用户可以通过轻扫来更改显示模式。您可以通过将 `presentsWithGesture` 属性设置为 `NO` 来禁用这个手势识别器。

`displayModeButtonItem` 方法返回一个特殊的条形按钮项，用于改变显示模式，你可以将其整合到你的应用程序的用户界面中。分体视图控制器管理该项的行为和外观。你所要做的就是把它添加到你的界面中适当的导航栏或工具栏中。当点击该按钮时，该按钮会向分页视图控制器发送一个动作，告诉它将当前的显示模式改变为由分页视图控制器的委托方的

 `targetDisplayModeForActionInSplitViewController:` 方法指定的显示模式。指定一个自动的显示模式（或者根本不执行委托代理方法）会导致分体视图控制器实现适合当前类的大小行为。例如，在纵向方向的 iPad 上，分体视图控制器会在隐藏模式和覆盖模式之间切换。基于手势的操作也会使用委托方法来决定采用哪种显示模式。



## 在分体视图界面中更改子视图控制器

在设计分体视图界面时，最好设置主视图控制器和从视图控制器，这两个位置都不要改变。一个常见的技巧是在两个位置安装导航视图控制器，然后根据需要推入和弹出新的内容。拥有这些类型的锚式视图控制器可以让你更容易专注于你的内容，并让分体视图控制器将其默认行为应用于整体界面。

如果您确实需要更改主视图控制器或从视图控制器，建议使用 `showViewController:sender:` 和 `showDetailViewController:sender:` 方法来进行更改。使用这些方法（而不是直接修改 viewControllers 属性）可以让分体视图控制器以最适合当前显示模式和大小类的方式显示指定的视图控制器。分体视图控制器知道如何以更直观的方式调整界面。它甚至可以和其他容器视图控制器（如导航控制器）一起工作，以呈现视图控制器。例如，在主视图控制器是导航控制器的紧凑环境中，调用 `showDetailViewController:sender:` 并不会取代从视图控制器。相反，主导航控制器会将视图控制器推送到它的导航栈上。



## 折叠和扩展分体视图界面

当分体视图控制器的大小在水平正常状态和水平紧凑状态之间切换时，分体视图控制器执行折叠和展开过渡。在这些转换期间，分体视图控制器会改变其显示子视图控制器的方式。当从水平正常状态切换到水平紧凑状态时，分体视图控制器会将一个视图控制器折叠到另一个视图控制器上。当从水平紧凑切换回水平规则时，它将再次展开界面，并根据显示模式显示一个或两个子视图控制器。

当过渡到折叠的界面时，分体视图控制器与它的委托一起管理过渡。在折叠过渡结束时，分体视图控制器通常只显示其主视图控制器的内容。您可以通过在分体视图控制器的 delegate 中实现 `primaryViewControllerForCollapsingSplitViewController:` 方法来改变这种行为。您可以使用该方法来指定从视图控制器或完全不同的视图控制器--也许是更适合在水平紧凑环境中显示的视图控制器。如果你想对视图控制器和视图层次结构执行任何额外的调整，你也可以在你的委托代理中实现 `splitViewController:collapseSecondaryViewController: ontoPrimaryViewController:`方法。

这个扩展过程通过要求委托代理指定哪个视图控制器成为主视图控制器，并给委托代理一个机会，让委托代理自己来执行这个过渡过程，从而逆转了折叠过程。如果你实现了委托方的方法来折叠你的分割视图接口，那么你还应该实现`primaryViewControllerForExpandingSplitViewController:`和`splitViewController:separateSecondaryViewControllerFromPrimaryViewController:`方法来扩展该接口。如果你没有实现任何方法，则分体控制器提供了默认的行为来处理折叠和展开过渡。

有关您用于管理折叠和展开过渡的方法的更多信息，请参阅 `UISplitViewControllerDelegate`。



## 将消息转发到其子视图控制器

分体视图控制器将自己置于应用程序的窗口和其子视图控制器之间。因此，所有流向子视图控制器的消息都必须通过分体视图控制器。这和你所期望的一样，消息的流向应该是相对直观的。例如，只有当相应的子视图控制器实际出现在屏幕上时，才会发送视图外观和消失消息。



## 状态保护

在 iOS 6 及以后的版本中，如果为这个分割视图控制器的 `restorationIdentifier` 属性指定一个值，它将保留任何拥有自己有效的还原标识符的子视图控制器。在下一个启动周期中，分割视图控制器会将保留的视图控制器恢复到之前的状态。分割视图控制器的子视图控制器可以使用相同的还原标识符。分割视图控制器会自动存储其他信息，以确保每个子视图控制器的还原路径是唯一的。

有关状态保存和恢复工作原理的更多信息，请参阅 iOS 的 App 编程指南。























